<script>
!function(window){
  const host="https://labs.heygen.com",
  url=host+"/guest/streaming-embed?share=eyJxdWFsaXR5IjoiaGlnaCIsImF2YXRhck5hbWUiOiJCcnlhbl9JVF9TaXR0aW5nX3B1YmxpYyIs%0D%0AInByZXZpZXdJbWciOiJodHRwczovL2ZpbGVzMi5oZXlnZW4uYWkvYXZhdGFyL3YzLzMzYzlhYzRh%0D%0AZWFkNDRkZmM4YmMwMDgyYTM1MDYyYTcwXzQ1NTgwL3ByZXZpZXdfdGFsa18zLndlYnAiLCJuZWVk%0D%0AUmVtb3ZlQmFja2dyb3VuZCI6ZmFsc2UsImtub3dsZWRnZUJhc2VJZCI6IjRkNDBhMDUzYzcyMTRl%0D%0AZGM5ZDEyODkyNDhjYmQzOGE3IiwidXNlcm5hbWUiOiI3YjE1MDNkNDhmZDU0YmJjODJjY2RiOTk3%0D%0AY2I2NzBlYSJ9&inIFrame=1",
  clientWidth=document.body.clientWidth,
  wrapDiv=document.createElement("div");
  wrapDiv.id="heygen-streaming-embed";

  const container=document.createElement("div");
  container.id="heygen-streaming-container";

  const stylesheet=document.createElement("style");
  stylesheet.innerHTML=`
    #heygen-streaming-embed {
      z-index: 9999;
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 200px;
      border-radius: 50%;
      border: 2px solid #fff;
      box-shadow: 0px 8px 24px 0px rgba(0, 0, 0, 0.12);
      transition: all linear 0.1s;
      overflow: hidden;
      opacity: 0;
      visibility: hidden;
    }
    #heygen-streaming-embed.show {
      opacity: 1;
      visibility: visible;
    }
    #heygen-streaming-embed.expand {
      ${clientWidth<540
        ?"height: 266px; width: 96%; top: 50%; left: 50%; transform: translate(-50%, -50%);"
        :"height: 366px; width: calc(366px * 16 / 9); top: 50%; left: 50%; transform: translate(-50%, -50%);"}
      border: 0;
      border-radius: 8px;
    }
    #heygen-streaming-container {
      width: 100%;
      height: 100%;
    }
    #heygen-streaming-container iframe {
      width: 100%;
      height: 100%;
      border: 0;
    }
  `;

  const iframe=document.createElement("iframe");
  iframe.allowFullscreen=!1;
  iframe.title="Streaming Embed";
  iframe.role="dialog";
  iframe.allow="microphone";
  iframe.src=url;

  let visible=!1,initial=!1;
  window.addEventListener("message",(e=>{
    e.origin===host&&e.data&&e.data.type&&"streaming-embed"===e.data.type&&(
      "init"===e.data.action?(initial=!0,wrapDiv.classList.toggle("show",initial)):
      "show"===e.data.action?(visible=!0,wrapDiv.classList.toggle("expand",visible)):
      "hide"===e.data.action&&(visible=!1,wrapDiv.classList.toggle("expand",visible))
    )
  }));

  container.appendChild(iframe);
  wrapDiv.appendChild(stylesheet);
  wrapDiv.appendChild(container);
  document.body.appendChild(wrapDiv)
}(globalThis);
</script>
